<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>La flor o el León — Obra de colección</title>

  <!-- Tipos elegantes y modernas -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">
  <!-- CSS específico inmersivo -->
  <link rel="stylesheet" href="STYLES/styles.css" />

  <!-- Metas para modal/código -->
  <meta name="piece-name" content="La flor o el León">
  <meta name="piece-category" content="Óleos">
  <meta name="piece-edition" content="1/20">
</head>
<body>

  <!-- ================= HERO con VIDEO ================= -->
  <header class="hero" aria-label="Presentación de la obra">
    <video class="hero__video" src="assets/hero.mp4" poster="assets/hero-poster.jpg" autoplay muted loop playsinline></video>
    <div class="hero__veil"></div>
    <div class="hero__copy">
      <h1 class="hero__title">La flor o el León</h1>
      <p class="hero__subtitle">Óleo sobre lienzo · 60×80 cm · 2025</p>
      <!-- Botón para abrir modal del código -->
      <button class="btn btn--ghost" id="openAccess">Conocer más de la historia</button>
    </div>
    <!-- Toggle de audio (opcional, se activa tras clic) -->
    <button class="audio-toggle" id="audioToggle" aria-pressed="false" aria-label="Activar/pausar audio">♫</button>
  </header>

  <main>
    <!-- ============ Inspiración (público) ============ -->
    <section class="section story-min">
      <h2>Inspiración</h2>
      <p>
        En los momentos donde la fe y el valor me pusieron a prueba, pinté mi león.
        Quería ser una leona, pero sabía que soy solo una flor. Y aunque parecen tan opuestos,
        son la dualidad de nuestras vidas: fragilidad, pero también fortaleza. Así somos.
      </p>
      <p><strong>Técnica:</strong> Óleo sobre lienzo. <strong>Medidas:</strong> 60 × 80 cm.</p>

      <div class="cta-row">
        <button class="btn btn--primary" type="button" data-pedir data-type="obra">Comprar obra</button>
        <button class="btn btn--ghost"   type="button" data-pedir data-type="gift">Comprar tarjeta de regalo</button>
        <button class="btn btn--link"    type="button" id="openAccessSecondary">Conocer más de la historia</button>
      </div>
      <small class="hint">
        La tarjeta de regalo desbloquea la <em>historia completa</em> y el proceso de pintado de esta pieza.
      </small>
    </section>

    <!-- =========================================================
         CONTENIDO EXCLUSIVO — aparece MUY BORROSO hasta ingresar el código
         arte-immersive.js quita el blur y el overlay al desbloquear.
         ========================================================= -->
    <section id="exclusive" class="exclusive" hidden>
      <!-- Video del proceso -->
      <section class="section wide" aria-label="Video del artista">
        <h2 data-reveal>Proceso del artista</h2>
        <video class="player" controls preload="metadata" poster="assets/hero-poster.jpg">
          <source src="assets/process.mp4" type="video/mp4">
        </video>
      </section>

      <!-- Historia extendida -->
      <section class="section story" aria-label="Historia completa">
        <h2 data-reveal>Historia completa</h2>
        <p data-reveal>
          Este cuadro nació de una pregunta íntima: ¿de dónde viene la fuerza cuando
          el corazón tiembla? Empecé con la flor, suave y casi transparente. A cada
          capa la dejé respirar: veladuras finas que iban templando la luz. Cuando
          apareció el primer trazo del león, entendí que no eran opuestos; eran una
          misma voz en registro distinto. La flor protege; el león sostiene.
        </p>
        <p data-reveal>
          Trabajé en silencio durante varias tardes. Entre capa y capa, el óleo
          pedía pausa; en esa espera escuchaba mis dudas y les daba un lugar.
          El pétalo final quedó imperfecto a propósito, como recordatorio de que
          la belleza también habita en lo que no se corrige. El ojo del león mira
          de frente, pero no hiere: afirma. Y yo, al firmarlo, sentí que algo en mí
          se había ordenado.
        </p>
        <p data-reveal>
          Esta pieza es un pequeño rito para recordar que la ternura no es lo
          contrario del coraje. La ternura <em>lo hace posible</em>.
        </p>
      </section>

      <!-- Ficha técnica -->
      <section class="section facts" aria-label="Ficha técnica">
        <h2 data-reveal>Ficha técnica</h2>
        <ul class="facts__list">
          <li data-reveal><strong>Soporte:</strong> Lienzo de algodón, grano medio</li>
          <li data-reveal><strong>Imprimatura:</strong> Base tibia en gris cálido</li>
          <li data-reveal><strong>Paleta:</strong> Blanco titanio, negro marfil, grises de mezcla; acentos ocre/dorado</li>
          <li data-reveal><strong>Herramientas:</strong> Pinceles redondos y planos; toques con espátula</li>
          <li data-reveal><strong>Barniz:</strong> Satín, curado final</li>
          <li data-reveal><strong>Tiempo de elaboración:</strong> 3–4 semanas con secados intermedios</li>
          <li data-reveal><strong>Firma:</strong> Reverso + certificado digital</li>
        </ul>
      </section>

      <!-- Galería HD -->
      <section class="section gallery" aria-label="Galería en alta resolución">
        <h2 data-reveal>Galería</h2>
        <div class="gallery__grid">
          <a href="assets/hd-1.jpg" class="gl" data-reveal><img src="assets/hd-1.jpg" alt="Detalle 1" loading="lazy" decoding="async"></a>
          <a href="assets/hd-2.jpg" class="gl" data-reveal><img src="assets/hd-2.jpg" alt="Detalle 2" loading="lazy" decoding="async"></a>
          <a href="assets/hd-3.jpg" class="gl" data-reveal><img src="assets/hd-3.jpg" alt="Detalle 3" loading="lazy" decoding="async"></a>
          <a href="assets/hd-4.jpg" class="gl" data-reveal><img src="assets/hd-4.jpg" alt="Detalle 4" loading="lazy" decoding="async"></a>
          <a href="assets/hd-5.jpg" class="gl" data-reveal><img src="assets/hd-5.jpg" alt="Detalle 5" loading="lazy" decoding="async"></a>
          <a href="assets/hd-6.jpg" class="gl" data-reveal><img src="assets/hd-6.jpg" alt="Detalle 6" loading="lazy" decoding="async"></a>
        </div>
      </section>

      <!-- Certificado digital -->
      <section class="section certificate" aria-label="Certificado digital">
        <h2 data-reveal>Certificado digital</h2>
        <div class="cert" data-reveal>
          <div class="cert__border"></div>
          <div class="cert__content">
            <h3>La flor o el León</h3>
            <p>ID de pieza: <span id="pieceId">—</span></p>
            <p>Número de colección: <strong id="edition2">—</strong></p>
            <p class="edition" id="edition">Pieza #1 de 20</p>
          </div>
        </div>
      </section>

      <!-- Audio inmersivo (opcional) -->
      <audio id="audioLoop" src="assets/audio-loop.mp3" loop preload="none"></audio>
      <audio id="audioFx"   src="assets/fire.wav"      loop preload="none"></audio>
    </section>
  </main>

  <!-- ============ Modal de acceso (código) ============ -->
  <dialog id="accessModal" class="modal" aria-labelledby="accessTitle">
    <form method="dialog" class="modal__dialog" id="accessForm">
      <button class="modal__close" aria-label="Cerrar">×</button>
      <h3 id="accessTitle">Acceso exclusivo</h3>
      <p>Ingresa el código para desbloquear la historia completa y el proceso.</p>

      <label for="accessCode" class="sr-only">Código de acceso</label>
      <input id="accessCode" name="code" type="text" inputmode="latin" autocomplete="one-time-code" placeholder="Código de acceso" required>
      <button class="btn btn--primary" type="submit">Ingresar</button>


      <div id="accessMsg" class="msg" aria-live="polite"></div>
    </form>
  </dialog>

  <!-- ============ Lightbox (galería) ============ -->
  <div id="lightbox" class="lightbox" hidden>
    <button class="lightbox__close" aria-label="Cerrar">×</button>
    <img id="lightboxImg" alt="">
  </div>

  <!-- ============ Modal de PEDIDO (misma página) ============ -->
  <div id="pedidoModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="pedidoTitle" hidden>
    <div class="modal-dialog">
      <button class="modal-close" type="button" aria-label="Cerrar">×</button>
      <h3 id="pedidoTitle">Solicitar</h3>
      <p class="modal-note"><strong>Exclusivo:</strong> El artista te contactará personalmente para continuar tu pedido.</p>

      <form id="pedidoForm" class="pedido-form">
        <div class="row">
          <label>Obra / Producto</label>
          <input type="text" id="obraNombre" name="obraNombre" readonly>
        </div>
        <div class="row">
          <label>Categoría</label>
          <input type="text" id="obraCategoria" name="obraCategoria" readonly>
        </div>
        <input type="hidden" id="obraURL" name="obraURL">
        <input type="hidden" id="obraThumb" name="obraThumb">

        <div class="row">
          <label>Nombre de contacto</label>
          <input type="text" id="contactoNombre" name="contactoNombre" required>
        </div>
        <div class="row">
          <label>Teléfono</label>
          <input type="tel" id="contactoTelefono" name="contactoTelefono" required>
        </div>
        <div class="row">
          <label>Notas</label>
          <textarea id="contactoNotas" name="contactoNotas" rows="4" placeholder="Cuéntanos detalles de tu pedido…"></textarea>
        </div>

        <div class="actions">
          <button class="btn btn--primary" type="submit">Enviar pedido</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ============ JS ============ -->
  <!-- 1) Tu JS inmersivo (blur + modal + validación de código) -->
  <script src="arte-immersive.js"></script>

  <!-- 2) JS mínimo para el modal de compra (obra / gift) -->
  <script>
    (function(){
      const $ = s => document.querySelector(s);
      const obra = (document.querySelector('meta[name="piece-name"]')?.content || 'Obra').trim();
      const cat  = (document.querySelector('meta[name="piece-category"]')?.content || 'Óleos').trim();

      const modal   = $('#pedidoModal');
      const mClose  = modal.querySelector('.modal-close');
      const form    = $('#pedidoForm');

      // Abrir: obra o tarjeta regalo
      document.addEventListener('click', (e)=>{
        const btn = e.target.closest('[data-pedir], #openAccessSecondary');
        if(!btn) return;
        if(btn.id==='openAccessSecondary') return; // este abre el modal de código (lo maneja arte-immersive.js)

        const type = btn.dataset.type; // obra | gift
        $('#obraNombre').value    = (type === 'gift')
          ? `Tarjeta de regalo — ${obra} (Historia completa)`
          : obra;
        $('#obraCategoria').value = cat;
        $('#obraURL').value       = location.href;
        $('#obraThumb').value     = 'assets/hero-poster.jpg';
        $('#contactoNotas').value = `Referido por: ${$('#obraNombre').value}. `;

        modal.hidden = false;
        document.body.style.overflow = 'hidden';
      });

      mClose.addEventListener('click', ()=>{ modal.hidden = true; document.body.style.overflow = ''; });
      modal.addEventListener('click', (e)=>{ if(e.target === modal){ modal.hidden = true; document.body.style.overflow = ''; } });

      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        alert('¡Gracias! Tu solicitud fue registrada. El artista te contactará personalmente.');
        form.reset();
        modal.hidden = true;
        document.body.style.overflow = '';
      });

      // Conectar botones que abren el modal de código
      const openA = document.getElementById('openAccess');
      const openB = document.getElementById('openAccessSecondary');
      [openA, openB].forEach(btn=>{
        btn?.addEventListener('click', ()=>{
          // arte-immersive.js escucha #openAccess, así que disparamos su handler:
          document.getElementById('openAccess')?.click?.();
        });
      });
    })();
  </script>
</body>
</html>
